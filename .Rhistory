summary(m2)
summary(m2)
summary(m2)
summary(m2)
summary(m2)
# change ordinal outcome
m2 = felm(proud_chilean  ~ change | idencuesta + year | 0 | idencuesta, data = d, keepCX = TRUE)
summary(m2)
m3 = felm(identify_chile  ~ change| idencuesta + ola | 0 | idencuesta, data = d, keepCX = TRUE)
summary(m3)
# change ordinal outcome
m2 = felm(proud_chilean  ~ change | idencuesta + year | 0 | idencuesta, data = d, keepCX = TRUE)
summary(m2)
summary(m3)
###############################
# All visas and crime concerns
###############################
rm(list=ls())
####################################
# Validity checks
####################################
rm(list=ls())
install.packages("effects")
#######################
# Analysis CEAD Chile
#######################
rm (list = ls())
library(foreign)
library(lmtest)
library(sandwich)
library(stargazer)
library(msm)
library(effects)
library(Hmisc)
library(ggplot2)
library(dplyr)
# load function that does clustered SEs
vcovCluster <- function(
model,
cluster
)
{
require(sandwich)
require(lmtest)
if(nrow(model.matrix(model))!=length(cluster)){
stop("check your data: cluster variable has different N than model")
}
M <- length(unique(cluster))
N <- length(cluster)
K <- model$rank
if(M<50){
warning("Fewer than 50 clusters, variances may be unreliable (could try block bootstrap instead).")
}
dfc <- (M/(M - 1)) * ((N - 1)/(N - K))
uj  <- apply(estfun(model), 2, function(x) tapply(x, cluster, sum));
rcse.cov <- dfc * sandwich(model, meat = crossprod(uj)/N)
return(rcse.cov)
}
##################
# Load clean data
##################
load("~/Dropbox/Crime Voting/01_data/clean_data/CEAD Chile/crime_voting_chile_final_2019oct29.RData")
names(d)
describe(d)
table(d$treatment)
table(d$treatment,d$rightwingpresident)
# rob check
d$tri12
d$tri12
d$tri12_6 = d$tri12 + d$tri9
d$tri6_0 = d$tri6 + d$tri3
d$diff = d$tri6_0 - d$tri12_6
differences = d$diff
differences_z = (differences - mean(differences))/sd(differences)
mean(differences_z)
sd(differences_z)
c = mean(differences) + sd(differences)
c
sum(differences > c)/length(differences)
d$treatment = NA
d$treatment[abs(d$diff) > c ] = 1
d$treatment[abs(d$diff) < c] = 0
table(d$treatment)
differences = d$diff
differences_z = (differences - mean(differences))/sd(differences)
mean(differences_z)
sd(differences_z)
c = mean(differences) + sd(differences)
c
d$treatment = NA
d$treatment[abs(d$diff) > c ] = 1
d$treatment[abs(d$diff) < c] = 0
table(d$treatment)
table(d$treatment, exclude = NULL)
d$interaction = d$treatment*d$rightwingpresident
table(d$treatment,d$rightwingpresident)
reg1 = lm(d$outcome ~ d$treatment + d$rightwingpresident + d$interaction + d$logpop2002_imp + d$dimedu03_imp + d$dimingresos03_imp + as.factor(d$codecounty) + as.factor(d$year))
reg1_c <- round(coeftest(reg1, vcov = vcovCluster(reg1, cluster = d$codecounty)),4)
reg2 = lm(d$outcome ~ d$treatment + d$rightwingpresident + d$interaction + d$dimedu03_imp + d$dimingresos03_imp + as.factor(d$codecounty) + as.factor(d$year))
reg2_c <- round(coeftest(reg2, vcov = vcovCluster(reg2, cluster = d$codecounty)),4)
reg3 = lm(d$outcome ~ d$treatment + d$rightwingpresident + d$interaction + d$dimingresos03_imp + as.factor(d$codecounty) + as.factor(d$year))
reg3_c <- round(coeftest(reg3, vcov = vcovCluster(reg3, cluster = d$codecounty)),4)
reg4 = lm(d$outcome ~ d$treatment + d$rightwingpresident + d$interaction + as.factor(d$codecounty) + as.factor(d$year))
reg4_c <- round(coeftest(reg4, vcov = vcovCluster(reg4, cluster = d$codecounty)),4)
reg1_c
stargazer(reg1_c,reg2_c,reg3_c,reg4_c,
type = "text",
align=TRUE,
omit.stat=c("LL","ser","f"),
no.space=TRUE,
multicolumn = TRUE,
covariate.labels=c("Crime shock","Right-wing president","Crime shock*Right-wing president"),
table.placement = "H",
#star.cutoffs = c(0.05,0.01,0.001),
#column.labels = c("Area as Treatment","Matched Sample"),
omit = c("codecounty","year","Constant","logpop2002_imp","dimedu03_imp","dimingresos03_imp"),
dep.var.caption  = "Change in the vote share for the incumbent",
#dep.var.labels   = "Electoral Choice",
add.lines = list(c("Observations", "932", "932", "932", "932"),
c("Municipality fixed effects", "Yes", "Yes", "Yes", "Yes"),
c("Year fixed effects", "Yes", "Yes", "Yes", "Yes"),
c("Placebo covariates", "3", "2", "1", "0")))
#######################
# Analysis CEAD Chile
#######################
rm (list = ls())
library(foreign)
library(lmtest)
library(sandwich)
library(stargazer)
library(msm)
library(effects)
library(Hmisc)
library(ggplot2)
library(dplyr)
# load function that does clustered SEs
vcovCluster <- function(
model,
cluster
)
{
require(sandwich)
require(lmtest)
if(nrow(model.matrix(model))!=length(cluster)){
stop("check your data: cluster variable has different N than model")
}
M <- length(unique(cluster))
N <- length(cluster)
K <- model$rank
if(M<50){
warning("Fewer than 50 clusters, variances may be unreliable (could try block bootstrap instead).")
}
dfc <- (M/(M - 1)) * ((N - 1)/(N - K))
uj  <- apply(estfun(model), 2, function(x) tapply(x, cluster, sum));
rcse.cov <- dfc * sandwich(model, meat = crossprod(uj)/N)
return(rcse.cov)
}
##################
# Load clean data
##################
load("~/Dropbox/Crime Voting/01_data/clean_data/CEAD Chile/crime_voting_chile_final_2019oct29.RData")
names(d)
describe(d)
table(d$treatment)
table(d$treatment,d$rightwingpresident)
# rob check
d$tri12 = (d$frecuencia_12m - d$frecuencia_9m)/d$frecuencia_12m
d$tri9 = (d$frecuencia_9m - d$frecuencia_6m)/d$frecuencia_12m
d$tri6 = (d$frecuencia_6m - d$frecuencia_3m)/d$frecuencia_12m
d$tri3 = d$frecuencia_3m/d$frecuencia_12m
d$diff3_12 = d$tri3 - d$tri12
d$diff3_9 = d$tri3 - d$tri9
d$diff3_6 = d$tri3 - d$tri6
d$diff6_9 = d$tri6 - d$tri9
d$diff9_12 = d$tri9 - d$tri12
differences = c(d$diff3_6,d$diff6_9,d$diff9_12)
differences_z = (differences - mean(differences))/sd(differences)
mean(differences_z)
sd(differences_z)
c = mean(differences) + sd(differences)
c
sum(differences > c)/length(differences)
c_neg = mean(differences) - sd(differences)
length(differences[differences>c_neg & differences<c])/length(differences)
d$treatment = NA
d$treatment[abs(d$diff9_12) < c & abs(d$diff6_9) < c & d$diff3_6 >= c] = 1
d$treatment[abs(d$diff9_12) < c & abs(d$diff6_9) < c & abs(d$diff3_6) < c] = 0
table(d$treatment)
##################
# Treatment
##################
d$interaction = d$treatment*d$rightwingpresident
table(d$treatment,d$rightwingpresident)
reg1 = lm(d$outcome ~ d$treatment + d$rightwingpresident + d$interaction + d$logpop2002_imp + d$dimedu03_imp + d$dimingresos03_imp + as.factor(d$codecounty) + as.factor(d$year))
reg1_c <- round(coeftest(reg1, vcov = vcovCluster(reg1, cluster = d$codecounty)),4)
reg2 = lm(d$outcome ~ d$treatment + d$rightwingpresident + d$interaction + d$dimedu03_imp + d$dimingresos03_imp + as.factor(d$codecounty) + as.factor(d$year))
reg2_c <- round(coeftest(reg2, vcov = vcovCluster(reg2, cluster = d$codecounty)),4)
reg3 = lm(d$outcome ~ d$treatment + d$rightwingpresident + d$interaction + d$dimingresos03_imp + as.factor(d$codecounty) + as.factor(d$year))
reg3_c <- round(coeftest(reg3, vcov = vcovCluster(reg3, cluster = d$codecounty)),4)
reg4 = lm(d$outcome ~ d$treatment + d$rightwingpresident + d$interaction + as.factor(d$codecounty) + as.factor(d$year))
reg4_c <- round(coeftest(reg4, vcov = vcovCluster(reg4, cluster = d$codecounty)),4)
stargazer(reg1_c,reg2_c,reg3_c,reg4_c,
type = "text",
align=TRUE,
omit.stat=c("LL","ser","f"),
no.space=TRUE,
multicolumn = TRUE,
covariate.labels=c("Crime shock","Right-wing president","Crime shock*Right-wing president"),
table.placement = "H",
#star.cutoffs = c(0.05,0.01,0.001),
#column.labels = c("Area as Treatment","Matched Sample"),
omit = c("codecounty","year","Constant","logpop2002_imp","dimedu03_imp","dimingresos03_imp"),
dep.var.caption  = "Change in the vote share for the incumbent",
#dep.var.labels   = "Electoral Choice",
add.lines = list(c("Observations", "932", "932", "932", "932"),
c("Municipality fixed effects", "Yes", "Yes", "Yes", "Yes"),
c("Year fixed effects", "Yes", "Yes", "Yes", "Yes"),
c("Placebo covariates", "3", "2", "1", "0")),
out="~/Dropbox/Crime Voting/02_analyses/Chile CEAD/results_chile.html")
#######################
# Analysis CEAD Chile
#######################
rm (list = ls())
library(foreign)
library(lmtest)
library(sandwich)
library(stargazer)
library(msm)
library(effects)
library(Hmisc)
library(ggplot2)
library(dplyr)
# load function that does clustered SEs
vcovCluster <- function(
model,
cluster
)
{
require(sandwich)
require(lmtest)
if(nrow(model.matrix(model))!=length(cluster)){
stop("check your data: cluster variable has different N than model")
}
M <- length(unique(cluster))
N <- length(cluster)
K <- model$rank
if(M<50){
warning("Fewer than 50 clusters, variances may be unreliable (could try block bootstrap instead).")
}
dfc <- (M/(M - 1)) * ((N - 1)/(N - K))
uj  <- apply(estfun(model), 2, function(x) tapply(x, cluster, sum));
rcse.cov <- dfc * sandwich(model, meat = crossprod(uj)/N)
return(rcse.cov)
}
##################
# Load clean data
##################
load("~/Dropbox/Crime Voting/01_data/clean_data/CEAD Chile/crime_voting_chile_final_2019oct29.RData")
names(d)
describe(d)
table(d$treatment)
table(d$treatment,d$rightwingpresident)
d$interaction = d$treatment*d$rightwingpresident
table(d$treatment,d$rightwingpresident)
reg1 = lm(d$outcome ~ d$treatment + d$rightwingpresident + d$interaction + d$logpop2002_imp + d$dimedu03_imp + d$dimingresos03_imp + as.factor(d$codecounty) + as.factor(d$year))
reg1_c <- round(coeftest(reg1, vcov = vcovCluster(reg1, cluster = d$codecounty)),4)
reg2 = lm(d$outcome ~ d$treatment + d$rightwingpresident + d$interaction + d$dimedu03_imp + d$dimingresos03_imp + as.factor(d$codecounty) + as.factor(d$year))
reg2_c <- round(coeftest(reg2, vcov = vcovCluster(reg2, cluster = d$codecounty)),4)
reg3 = lm(d$outcome ~ d$treatment + d$rightwingpresident + d$interaction + d$dimingresos03_imp + as.factor(d$codecounty) + as.factor(d$year))
reg3_c <- round(coeftest(reg3, vcov = vcovCluster(reg3, cluster = d$codecounty)),4)
reg4 = lm(d$outcome ~ d$treatment + d$rightwingpresident + d$interaction + as.factor(d$codecounty) + as.factor(d$year))
reg4_c <- round(coeftest(reg4, vcov = vcovCluster(reg4, cluster = d$codecounty)),4)
stargazer(reg1_c,reg2_c,reg3_c,reg4_c,
type = "text",
align=TRUE,
omit.stat=c("LL","ser","f"),
no.space=TRUE,
multicolumn = TRUE,
covariate.labels=c("Crime shock","Right-wing president","Crime shock*Right-wing president"),
table.placement = "H",
#star.cutoffs = c(0.05,0.01,0.001),
#column.labels = c("Area as Treatment","Matched Sample"),
omit = c("codecounty","year","Constant","logpop2002_imp","dimedu03_imp","dimingresos03_imp"),
dep.var.caption  = "Change in the vote share for the incumbent",
#dep.var.labels   = "Electoral Choice",
add.lines = list(c("Observations", "932", "932", "932", "932"),
c("Municipality fixed effects", "Yes", "Yes", "Yes", "Yes"),
c("Year fixed effects", "Yes", "Yes", "Yes", "Yes"),
c("Placebo covariates", "3", "2", "1", "0")),
out="~/Dropbox/Crime Voting/02_analyses/Chile CEAD/results_chile.html")
##########################
View(d)
differences = c((d$tri3 + d$tri6) - (d$tri9 + d$tri12))
differences
differences_z = (differences - mean(differences))/sd(differences)
mean(differences_z)
differences_z
x = data.frame(differences,differences_z)
View(x)
View(x)
mean(differences_z)
sd(differences_z)
c = mean(differences) + sd(differences)
c
sum(differences > c)/length(differences)
c_neg = mean(differences) - sd(differences)
length(differences[differences>c_neg & differences<c])/length(differences)
d$treatment2 = NA
d$treatment2[d$differences >= 1] = 1
d$treatment2[d$differences < 1] = 0
table(d$treatment2)
d$differences = c((d$tri3 + d$tri6) - (d$tri9 + d$tri12))
d$differences_z = (differences - mean(differences))/sd(differences)
mean(d$differences_z)
sd(d$differences_z)
d$treatment2 = NA
d$treatment2[d$differences >= 1] = 1
d$treatment2[d$differences < 1] = 0
table(d$treatment2)
d$differences
d$differences_z
sd(d$differences_z)
d$treatment2 = NA
d$treatment2[d$differences_z >= 1] = 1
d$treatment2[d$differences_z < 1] = 0
table(d$treatment2)
d$interaction = d$treatment2*d$rightwingpresident
table(d$treatment2,d$rightwingpresident)
reg1 = lm(d$outcome ~ d$treatment2 + d$rightwingpresident + d$interaction + d$logpop2002_imp + d$dimedu03_imp + d$dimingresos03_imp + as.factor(d$codecounty) + as.factor(d$year))
reg1_c <- round(coeftest(reg1, vcov = vcovCluster(reg1, cluster = d$codecounty)),4)
reg2 = lm(d$outcome ~ d$treatment2 + d$rightwingpresident + d$interaction + d$dimedu03_imp + d$dimingresos03_imp + as.factor(d$codecounty) + as.factor(d$year))
reg2_c <- round(coeftest(reg2, vcov = vcovCluster(reg2, cluster = d$codecounty)),4)
reg3 = lm(d$outcome ~ d$treatment2 + d$rightwingpresident + d$interaction + d$dimingresos03_imp + as.factor(d$codecounty) + as.factor(d$year))
reg3_c <- round(coeftest(reg3, vcov = vcovCluster(reg3, cluster = d$codecounty)),4)
reg4 = lm(d$outcome ~ d$treatment2 + d$rightwingpresident + d$interaction + as.factor(d$codecounty) + as.factor(d$year))
reg4_c <- round(coeftest(reg4, vcov = vcovCluster(reg4, cluster = d$codecounty)),4)
stargazer(reg1_c,reg2_c,reg3_c,reg4_c,
type = "text",
align=TRUE,
omit.stat=c("LL","ser","f"),
no.space=TRUE,
multicolumn = TRUE,
covariate.labels=c("Crime shock","Right-wing president","Crime shock*Right-wing president"),
table.placement = "H",
#star.cutoffs = c(0.05,0.01,0.001),
#column.labels = c("Area as Treatment","Matched Sample"),
omit = c("codecounty","year","Constant","logpop2002_imp","dimedu03_imp","dimingresos03_imp"),
dep.var.caption  = "Change in the vote share for the incumbent",
#dep.var.labels   = "Electoral Choice",
add.lines = list(c("Observations", "932", "932", "932", "932"),
c("Municipality fixed effects", "Yes", "Yes", "Yes", "Yes"),
c("Year fixed effects", "Yes", "Yes", "Yes", "Yes"),
c("Placebo covariates", "3", "2", "1", "0")))
d$differences
sd(d$differences)
d$treatment2 = NA
d$treatment2[d$differences >= 0.1005084] = 1
d$treatment2[d$differences < 0.1005084] = 0
table(d$treatment2)
d$interaction = d$treatment2*d$rightwingpresident
table(d$treatment2,d$rightwingpresident)
reg1 = lm(d$outcome ~ d$treatment2 + d$rightwingpresident + d$interaction + d$logpop2002_imp + d$dimedu03_imp + d$dimingresos03_imp + as.factor(d$codecounty) + as.factor(d$year))
reg1_c <- round(coeftest(reg1, vcov = vcovCluster(reg1, cluster = d$codecounty)),4)
reg2 = lm(d$outcome ~ d$treatment2 + d$rightwingpresident + d$interaction + d$dimedu03_imp + d$dimingresos03_imp + as.factor(d$codecounty) + as.factor(d$year))
reg2_c <- round(coeftest(reg2, vcov = vcovCluster(reg2, cluster = d$codecounty)),4)
reg3 = lm(d$outcome ~ d$treatment2 + d$rightwingpresident + d$interaction + d$dimingresos03_imp + as.factor(d$codecounty) + as.factor(d$year))
reg3_c <- round(coeftest(reg3, vcov = vcovCluster(reg3, cluster = d$codecounty)),4)
reg4 = lm(d$outcome ~ d$treatment2 + d$rightwingpresident + d$interaction + as.factor(d$codecounty) + as.factor(d$year))
reg4_c <- round(coeftest(reg4, vcov = vcovCluster(reg4, cluster = d$codecounty)),4)
stargazer(reg1_c,reg2_c,reg3_c,reg4_c,
type = "text",
align=TRUE,
omit.stat=c("LL","ser","f"),
no.space=TRUE,
multicolumn = TRUE,
covariate.labels=c("Crime shock","Right-wing president","Crime shock*Right-wing president"),
table.placement = "H",
#star.cutoffs = c(0.05,0.01,0.001),
#column.labels = c("Area as Treatment","Matched Sample"),
omit = c("codecounty","year","Constant","logpop2002_imp","dimedu03_imp","dimingresos03_imp"),
dep.var.caption  = "Change in the vote share for the incumbent",
#dep.var.labels   = "Electoral Choice",
add.lines = list(c("Observations", "932", "932", "932", "932"),
c("Municipality fixed effects", "Yes", "Yes", "Yes", "Yes"),
c("Year fixed effects", "Yes", "Yes", "Yes", "Yes"),
c("Placebo covariates", "3", "2", "1", "0")))
d$differences_z
mean(d$differences_z)
d$differences
d$treatment2 = NA
d$treatment2[d$differences_z >= 1] = 1
d$treatment2[d$differences < 0] = 0
table(d$treatment2)
d$interaction = d$treatment2*d$rightwingpresident
table(d$treatment2,d$rightwingpresident)
reg1 = lm(d$outcome ~ d$treatment2 + d$rightwingpresident + d$interaction + d$logpop2002_imp + d$dimedu03_imp + d$dimingresos03_imp + as.factor(d$codecounty) + as.factor(d$year))
reg1_c <- round(coeftest(reg1, vcov = vcovCluster(reg1, cluster = d$codecounty)),4)
reg2 = lm(d$outcome ~ d$treatment2 + d$rightwingpresident + d$interaction + d$dimedu03_imp + d$dimingresos03_imp + as.factor(d$codecounty) + as.factor(d$year))
reg2_c <- round(coeftest(reg2, vcov = vcovCluster(reg2, cluster = d$codecounty)),4)
reg3 = lm(d$outcome ~ d$treatment2 + d$rightwingpresident + d$interaction + d$dimingresos03_imp + as.factor(d$codecounty) + as.factor(d$year))
reg3_c <- round(coeftest(reg3, vcov = vcovCluster(reg3, cluster = d$codecounty)),4)
reg4 = lm(d$outcome ~ d$treatment2 + d$rightwingpresident + d$interaction + as.factor(d$codecounty) + as.factor(d$year))
reg4_c <- round(coeftest(reg4, vcov = vcovCluster(reg4, cluster = d$codecounty)),4)
stargazer(reg1_c,reg2_c,reg3_c,reg4_c,
type = "text",
align=TRUE,
omit.stat=c("LL","ser","f"),
no.space=TRUE,
multicolumn = TRUE,
covariate.labels=c("Crime shock","Right-wing president","Crime shock*Right-wing president"),
table.placement = "H",
#star.cutoffs = c(0.05,0.01,0.001),
#column.labels = c("Area as Treatment","Matched Sample"),
omit = c("codecounty","year","Constant","logpop2002_imp","dimedu03_imp","dimingresos03_imp"),
dep.var.caption  = "Change in the vote share for the incumbent",
#dep.var.labels   = "Electoral Choice",
add.lines = list(c("Observations", "932", "932", "932", "932"),
c("Municipality fixed effects", "Yes", "Yes", "Yes", "Yes"),
c("Year fixed effects", "Yes", "Yes", "Yes", "Yes"),
c("Placebo covariates", "3", "2", "1", "0")))
#######################
# Analysis CEAD Chile
#######################
rm (list = ls())
library(foreign)
library(lmtest)
library(sandwich)
library(stargazer)
library(msm)
library(effects)
library(Hmisc)
library(ggplot2)
library(dplyr)
# load function that does clustered SEs
vcovCluster <- function(
model,
cluster
)
{
require(sandwich)
require(lmtest)
if(nrow(model.matrix(model))!=length(cluster)){
stop("check your data: cluster variable has different N than model")
}
M <- length(unique(cluster))
N <- length(cluster)
K <- model$rank
if(M<50){
warning("Fewer than 50 clusters, variances may be unreliable (could try block bootstrap instead).")
}
dfc <- (M/(M - 1)) * ((N - 1)/(N - K))
uj  <- apply(estfun(model), 2, function(x) tapply(x, cluster, sum));
rcse.cov <- dfc * sandwich(model, meat = crossprod(uj)/N)
return(rcse.cov)
}
##################
# Load clean data
##################
load("~/Dropbox/Crime Voting/01_data/clean_data/CEAD Chile/crime_voting_chile_final_2019oct29.RData")
names(d)
describe(d)
table(d$treatment)
table(d$treatment,d$rightwingpresident)
# rob check
d$differences = c((d$tri3 + d$tri6) - (d$tri9 + d$tri12))
d$differences_z = (differences - mean(differences))/sd(differences)
mean(d$differences_z)
sd(d$differences_z)
d$treatment2 = NA
d$treatment2[d$differences_z >= 1] = 1
d$treatment2[d$differences < 0] = 0
table(d$treatment2)
##################
# Treatment
##################
d$interaction = d$treatment2*d$rightwingpresident
table(d$treatment2,d$rightwingpresident)
reg1 = lm(d$outcome ~ d$treatment2 + d$rightwingpresident + d$interaction + d$logpop2002_imp + d$dimedu03_imp + d$dimingresos03_imp + as.factor(d$codecounty) + as.factor(d$year))
reg1_c <- round(coeftest(reg1, vcov = vcovCluster(reg1, cluster = d$codecounty)),4)
reg2 = lm(d$outcome ~ d$treatment2 + d$rightwingpresident + d$interaction + d$dimedu03_imp + d$dimingresos03_imp + as.factor(d$codecounty) + as.factor(d$year))
reg2_c <- round(coeftest(reg2, vcov = vcovCluster(reg2, cluster = d$codecounty)),4)
reg3 = lm(d$outcome ~ d$treatment2 + d$rightwingpresident + d$interaction + d$dimingresos03_imp + as.factor(d$codecounty) + as.factor(d$year))
reg3_c <- round(coeftest(reg3, vcov = vcovCluster(reg3, cluster = d$codecounty)),4)
reg4 = lm(d$outcome ~ d$treatment2 + d$rightwingpresident + d$interaction + as.factor(d$codecounty) + as.factor(d$year))
reg4_c <- round(coeftest(reg4, vcov = vcovCluster(reg4, cluster = d$codecounty)),4)
stargazer(reg1_c,reg2_c,reg3_c,reg4_c,
type = "text",
align=TRUE,
omit.stat=c("LL","ser","f"),
no.space=TRUE,
multicolumn = TRUE,
covariate.labels=c("Crime shock","Right-wing president","Crime shock*Right-wing president"),
table.placement = "H",
#star.cutoffs = c(0.05,0.01,0.001),
#column.labels = c("Area as Treatment","Matched Sample"),
omit = c("codecounty","year","Constant","logpop2002_imp","dimedu03_imp","dimingresos03_imp"),
dep.var.caption  = "Change in the vote share for the incumbent",
#dep.var.labels   = "Electoral Choice",
add.lines = list(c("Observations", "932", "932", "932", "932"),
c("Municipality fixed effects", "Yes", "Yes", "Yes", "Yes"),
c("Year fixed effects", "Yes", "Yes", "Yes", "Yes"),
c("Placebo covariates", "3", "2", "1", "0")))
table(d$treatment2, exclude = NULL)
d$treatment2 = NA
d$treatment2[d$differences_z >= 1] = 1
d$treatment2[d$differences < 0] = 0
table(d$treatment2)
install.packages("gdata")
###############################
# County level analysis
###############################
rm(list=ls())
